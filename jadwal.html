<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');

body {
    font-family: 'Plus Jakarta Sans', sans-serif;
    background: transparent;
    margin: 0;
    padding: 0;
    overflow: hidden;
}
</style>
</head>

<body>

<div id="content-wrapper" class="p-2">

<div class="bg-slate-900 rounded-[2.5rem] shadow-2xl border border-white/10 overflow-hidden p-6 md:p-8 text-white">

<!-- HEADER -->
<div class="text-center mb-6">
    <h2 class="text-xl md:text-2xl font-extrabold uppercase tracking-tight">
        Jadwal Shalat & Imsakiyah
    </h2>

    <p id="tanggalMasehi" class="text-sm text-slate-400 mt-3"></p>
    <p id="tanggalHijriyah" class="text-sm text-slate-400"></p>

    <div class="mt-3">
        <p class="text-xs uppercase tracking-widest text-slate-400">
            Waktu Sekarang
        </p>
        <p id="jamRealtime" class="text-2xl font-mono text-cyan-400 mt-1 tracking-widest">
            00:00:00 WIB
        </p>
    </div>
</div>

<!-- COUNTDOWN -->
<div id="countdownContainer" class="text-center mb-6">
    <p class="text-red-500 font-semibold mb-3">
        Menuju Ramadan 1447 H
    </p>

    <div class="grid grid-cols-4 gap-3 max-w-md mx-auto">
        <div class="bg-white/5 p-3 rounded-xl">
            <p id="cdHari" class="text-2xl font-black">0</p>
            <p class="text-xs text-slate-400">Hari</p>
        </div>
        <div class="bg-white/5 p-3 rounded-xl">
            <p id="cdJam" class="text-2xl font-black">0</p>
            <p class="text-xs text-slate-400">Jam</p>
        </div>
        <div class="bg-white/5 p-3 rounded-xl">
            <p id="cdMenit" class="text-2xl font-black">0</p>
            <p class="text-xs text-slate-400">Menit</p>
        </div>
        <div class="bg-white/5 p-3 rounded-xl">
            <p id="cdDetik" class="text-2xl font-black">0</p>
            <p class="text-xs text-slate-400">Detik</p>
        </div>
    </div>

    <p class="text-slate-400 text-xs mt-4 italic">
        Ramadan 1447 H insyaAllah akan dimulai pada 18 Februari 2026.
    </p>
</div>

<p id="hariKeRamadan" class="text-center text-green-400 font-semibold mb-4"></p>

<!-- JADWAL -->
<div class="grid grid-cols-2 md:grid-cols-5 gap-3 text-center">

<div class="bg-white/5 p-4 rounded-xl">
<p class="text-xs text-slate-400 uppercase mb-1">Imsak</p>
<p id="imsak" class="text-lg font-bold">--:--</p>
</div>

<div class="bg-white/5 p-4 rounded-xl">
<p class="text-xs text-slate-400 uppercase mb-1">Subuh</p>
<p id="subuh" class="text-lg font-bold">--:--</p>
</div>

<div class="bg-white/5 p-4 rounded-xl">
<p class="text-xs text-slate-400 uppercase mb-1">Dzuhur</p>
<p id="zuhur" class="text-lg font-bold">--:--</p>
</div>

<div class="bg-red-700 p-4 rounded-xl shadow-lg">
<p class="text-xs text-white/70 uppercase mb-1">Maghrib</p>
<p id="magrib" class="text-xl font-black">--:--</p>
</div>

<div class="bg-white/5 p-4 rounded-xl">
<p class="text-xs text-slate-400 uppercase mb-1">Isya</p>
<p id="isya" class="text-lg font-bold">--:--</p>
</div>

</div>

</div>
</div>

<script>

const RAMADAN_START = new Date(2026,1,18);
const RAMADAN_END   = new Date(2026,2,19);

const JADWAL_UMUM = {
    imsak: "04:20",
    subuh: "04:30",
    zuhur: "11:50",
    magrib:"17:50",
    isya:  "19:00"
};

function updateTanggal() {
    const now = new Date();

    document.getElementById("tanggalMasehi").textContent =
        now.toLocaleDateString("id-ID", { weekday:"long", day:"numeric", month:"long", year:"numeric" });

    document.getElementById("tanggalHijriyah").textContent =
        now.toLocaleDateString("id-ID-u-ca-islamic", { day:"numeric", month:"long", year:"numeric" });
}

function updateJam() {
    const now = new Date();
    document.getElementById("jamRealtime").textContent =
        now.toLocaleTimeString("id-ID") + " WIB";
}

function updateCountdown() {
    const now = new Date();
    const diff = RAMADAN_START - now;

    if (diff > 0) {
        const totalSeconds = Math.floor(diff / 1000);
        document.getElementById("cdHari").textContent  = Math.floor(totalSeconds / 86400);
        document.getElementById("cdJam").textContent   = Math.floor((totalSeconds % 86400)/3600);
        document.getElementById("cdMenit").textContent = Math.floor((totalSeconds % 3600)/60);
        document.getElementById("cdDetik").textContent = totalSeconds % 60;
    } else {
        document.getElementById("countdownContainer").style.display = "none";
    }
}

async function loadJadwal() {
    const response = await fetch("https://daeng923.github.io/ramadan/ramadan-1447-malang.json");
    const result = await response.json();
    const data = result.data;

    const now = new Date();
    const todayString = now.getFullYear()+"-"+String(now.getMonth()+1).padStart(2,'0')+"-"+String(now.getDate()).padStart(2,'0');

    let todayData = data.find(item => item.date === todayString);
    if (!todayData) todayData = JADWAL_UMUM;

    document.getElementById("imsak").textContent  = todayData.imsak;
    document.getElementById("subuh").textContent  = todayData.subuh;
    document.getElementById("zuhur").textContent  = todayData.zuhur;
    document.getElementById("magrib").textContent = todayData.magrib;
    document.getElementById("isya").textContent   = todayData.isya;

    if (now >= RAMADAN_START && now <= RAMADAN_END) {
        const dayNumber = Math.floor((now - RAMADAN_START)/(1000*60*60*24)) + 1;
        document.getElementById("hariKeRamadan").textContent =
            "Hari ke-" + dayNumber + " Ramadan 1447 H";
    }

    setTimeout(() => {
        const height = document.getElementById('content-wrapper').scrollHeight;
        window.parent.postMessage({ height: height }, '*');
    }, 500);
}

updateTanggal();
updateJam();
updateCountdown();
loadJadwal();

setInterval(updateJam, 1000);
setInterval(updateCountdown, 1000);

</script>

</body>
</html>
