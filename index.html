<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: transparent; margin: 0; padding: 0; overflow: hidden; }
        .text-flexible { white-space: normal !important; word-wrap: break-word !important; display: block !important; }

        /* ANIMASI BERKELIP (BLINK/PULSE) */
        @keyframes blinker {
            50% { opacity: 0.3; transform: scale(0.95); }
        }
        .animate-attention {
            animation: blinker 1.5s linear infinite;
        }
    </style>
</head>
<body>
    <div id="content-wrapper" class="p-2">
        <div class="bg-slate-900 rounded-[2.5rem] shadow-2xl border-4 border-[#800000]/20 overflow-hidden">
            <div class="p-6 md:p-8 text-center border-b border-white/5 bg-slate-900">
                <span class="animate-attention inline-block bg-red-600 text-white px-4 py-1 rounded-full text-[10px] font-black uppercase tracking-widest mb-4 shadow-[0_0_15px_rgba(220,38,38,0.5)]">
                    Agenda Terdekat
                </span>
                
                <h2 id="judul-kegiatan" class="text-2xl md:text-4xl font-extrabold text-white leading-tight uppercase tracking-tighter">Memuat...</h2>
                <p id="tema-kegiatan" class="text-red-400 text-xs md:text-base font-bold mt-3 uppercase italic tracking-wide text-flexible">---</p>
            </div>

            <div class="p-6 md:p-10 space-y-8 bg-white/5">
                <div class="flex items-start gap-6">
                    <div class="w-16 h-16 md:w-20 md:h-20 bg-[#800000] rounded-3xl flex flex-col items-center justify-center text-white shadow-lg shrink-0">
                        <span id="label-bulan" class="text-[10px] font-bold uppercase text-white/70">RAM</span>
                        <span id="label-tanggal" class="text-2xl md:text-3xl font-black leading-none">--</span>
                    </div>
                    <div class="text-flexible text-left text-white">
                        <p id="nama-pemateri" class="font-bold text-xl md:text-2xl leading-tight">---</p>
                        <p id="jabatan-pemateri" class="text-red-400 text-[10px] md:text-xs font-semibold uppercase mt-1 tracking-widest">---</p>
                    </div>
                </div>

                <div class="space-y-6 pt-6 border-t border-white/10 text-white">
                    <div class="flex items-start gap-5">
                        <div class="bg-red-600/20 p-2.5 rounded-xl text-red-500">üóìÔ∏è</div>
                        <div class="text-flexible text-left">
                            <p id="hari-tanggal" class="font-bold text-base md:text-lg">---</p>
                            <p id="tanggal-hijriah" class="text-slate-400 text-sm mt-1">---</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-5">
                        <div class="bg-red-600/20 p-2.5 rounded-xl text-red-500">üïí</div>
                        <p id="waktu-kegiatan" class="font-bold text-base md:text-lg self-center">---</p>
                    </div>
                    <div class="flex items-start gap-5">
                        <div class="bg-red-600/20 p-2.5 rounded-xl text-red-500">üìç</div>
                        <p id="lokasi-kegiatan" class="font-bold text-base md:text-lg leading-snug text-flexible text-left">---</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT5TOa5s6GmnerYw30TEujxG7JkZNw7pyOZbxDF4gkFCHad_en-z8akhLba3SmMbRYhBkltyjGDc1TK/pub?gid=0&single=true&output=csv';

        async function fetchHighlight() {
            try {
                const res = await fetch(csvUrl);
                const text = await res.text();
                const rows = text.split('\n');
                const dataRow = rows[1];
                
                const cols = [];
                let current = "";
                let inQuotes = false;
                for (let char of dataRow) {
                    if (char === '"') inQuotes = !inQuotes;
                    else if (char === ',' && !inQuotes) { cols.push(current.trim()); current = ""; }
                    else current += char;
                }
                cols.push(current.trim());

                document.getElementById('judul-kegiatan').innerText = cols[0];
                document.getElementById('tema-kegiatan').innerText = cols[1];
                document.getElementById('nama-pemateri').innerText = cols[2];
                document.getElementById('jabatan-pemateri').innerText = cols[3];
                document.getElementById('hari-tanggal').innerText = cols[4];
                document.getElementById('tanggal-hijriah').innerText = cols[5];
                document.getElementById('waktu-kegiatan').innerText = cols[6];
                document.getElementById('lokasi-kegiatan').innerText = cols[7];

                const tglMatch = cols[4].match(/\d+/);
                if(tglMatch) document.getElementById('label-tanggal').innerText = tglMatch[0].padStart(2, '0');
                const blnMatch = cols[4].match(/[a-zA-Z]+/g);
                if(blnMatch && blnMatch[1]) document.getElementById('label-bulan').innerText = blnMatch[1].substring(0,3).toUpperCase();

                setTimeout(() => {
                    const height = document.getElementById('content-wrapper').scrollHeight;
                    window.parent.postMessage({ height: height }, '*');
                }, 500);
            } catch (err) { console.error(err); }
        }
        window.onload = fetchHighlight;
    </script>
</body>
</html>
